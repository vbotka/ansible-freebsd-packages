---

- name: "conf: Configure /etc/pkg/FreeBSD.conf"
  ansible.builtin.template:
    src: repo.j2
    dest: "/etc/pkg/FreeBSD.conf"
    owner: "{{ pkg_owner }}"
    group: "{{ pkg_group }}"
    mode: "0644"
    backup: "{{ pkg_backup_conf }}"
  loop: "{{ pkg_default_repo_conf }}"
  loop_control:
    label: "{{ item.name }}"

- name: "conf: Create /usr/local/etc/pkg"
  ansible.builtin.file:
    state: directory
    path: /usr/local/etc/pkg
    owner: "{{ pkg_owner }}"
    group: "{{ pkg_group }}"
    mode: "0755"

- name: "conf: Create /usr/local/etc/pkg/repos"
  ansible.builtin.file:
    state: directory
    path: /usr/local/etc/pkg/repos
    owner: "{{ pkg_owner }}"
    group: "{{ pkg_group }}"
    mode: "0755"

- name: "conf: Configure /usr/local/etc/pkg/repos/FreeBSD.conf"
  ansible.builtin.template:
    src: FreeBSD.conf.j2
    dest: /usr/local/etc/pkg/repos/FreeBSD.conf
    owner: "{{ pkg_owner }}"
    group: "{{ pkg_group }}"
    mode: "0644"
    backup: "{{ pkg_backup_conf }}"
  when: not pkg_default_repo|bool

- name: "conf: Remove /usr/local/etc/pkg/repos/FreeBSD.conf"
  ansible.builtin.file:
    state: absent
    path: /usr/local/etc/pkg/repos/FreeBSD.conf
  when: pkg_default_repo|bool

- name: "conf: Configure package repositories"
  ansible.builtin.template:
    src: repo.j2
    dest: "/usr/local/etc/pkg/repos/{{ item.name }}.conf"
    owner: "{{ pkg_owner }}"
    group: "{{ pkg_group }}"
    mode: "0644"
    backup: "{{ pkg_backup_conf }}"
  loop: "{{ pkg_repo }}"

# EOF
...
